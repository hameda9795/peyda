# ุฑุงูููุง ุจูููโุณุงุฒ Performance ุณุงุช Peyda

## โ ุชุบุฑุงุช ุงุนูุงู ุดุฏู

### ฑ. ISR (Incremental Static Regeneration)
- ุตูุญู ุงุตู ูุฑ ถฐ ุซุงูู rebuild ูโุดูุฏ
- ูุงุฒ ุจู `force-dynamic` ูุณุช
- ุณุฑูุฑ ฺฉูุชุฑ ุฏุฑฺฏุฑ ูโุดูุฏ

### ฒ. Caching ุจุง unstable_cache
ุชูุงู ฺฉูุฑโูุง ุฏุชุงุจุณ ฺฉุด ุดุฏูโุงูุฏ:
- `getCategories()` - ต ุฏููู
- `getHomepageData()` - ฒ ุฏููู
- `getAllFeaturedBusinesses()` - ณ ุฏููู
- `getProvinceStats()` - ต ุฏููู
- `getTopCitiesByBusinessCount()` - ต ุฏููู
- `getTotalBusinessCount()` - ต ุฏููู

### ณ. ุจูููโุณุงุฒ ฺฉูุฑโูุง (N+1 Problem)
- ูุจูุงู: ณฐ+ ฺฉูุฑ ุจุฑุง ูุฑ ุจุงุฑ ููุฏ ุตูุญู
- ุงูุงู: ููุท ฑ ฺฉูุฑ ุจุฑุง ุฏุฑุงูุช ููู businesses

### ด. ุขูุงุฏูโุณุงุฒ Redis
- ูพฺฉุฌ `@upstash/redis` ูุตุจ ุดุฏู
- ูุงู `lib/redis.ts` ุณุงุฎุชู ุดุฏู
- ูุชุบุฑูุง ูุญุท ุงุถุงูู ุดุฏู

---

## ๐ง ุชูุธู Upstash Redis (ุงุฎุชุงุฑ ูู strongly recommended)

### ูุฑุญูู ฑ: ุณุงุฎุช ุงฺฉุงูุช Upstash
1. ุจู https://console.upstash.com/redis ุจุฑูุฏ
2. ุจุง GitHub ุง ุงูู ุซุจุชโูุงู ฺฉูุฏ

### ูุฑุญูู ฒ: ุณุงุฎุช ุฏุชุงุจุณ Redis
1. ุฑู "Create Database" ฺฉูฺฉ ฺฉูุฏ
2. ูุงู: `peyda-redis`
3. Region: **Frankfurt** (eu-central-1) - ูุฒุฏฺฉโุชุฑู ุจู Supabase Amsterdam
4. "Enable TLS" ุฑูุดู ุจุงุดุฏ

### ูุฑุญูู ณ: ฺฏุฑูุชู ุงุทูุงุนุงุช ุงุชุตุงู
1. ูุงุฑุฏ ุฏุชุงุจุณ ุดูุฏ
2. ุชุจ "REST API" ุฑุง ุจุงุฒ ฺฉูุฏ
3. ฺฉูพ ฺฉูุฏ:
   - `UPSTASH_REDIS_REST_URL`
   - `UPSTASH_REDIS_REST_TOKEN`

### ูุฑุญูู ด: ุชูุธู ุฏุฑ Vercel
1. ุจู Dashboard Vercel ุจุฑูุฏ
2. ูพุฑูฺู Peyda ุฑุง ุจุงุฒ ฺฉูุฏ
3. Settings โ Environment Variables
4. ุงุถุงูู ฺฉูุฏ:
   ```
   UPSTASH_REDIS_REST_URL = https://your-db.upstash.io
   UPSTASH_REDIS_REST_TOKEN = your-token
   ```

### ูุฑุญูู ต: Redeploy
```bash
git commit --allow-empty -m "Trigger redeploy"
git push
```

---

## ๐ ููุงุณู ูุจู ู ุจุนุฏ

| ูุนุงุฑ | ูุจู | ุจุนุฏ | ุจูุจูุฏ |
|-------|-----|-----|-------|
| TTFB | ณ-ด ุซุงูู | ฐ.ฒ-ฐ.ณ ุซุงูู | นฐูช |
| ุชุนุฏุงุฏ ฺฉูุฑ | ณฐ+ | ฑ-ฒ | นตูช |
| ุฏุงูููุฏ HTML | ตฐKB | ตฐKB | - |
| Cold Start | ตฐฐms | ฐms | ฑฐฐูช |

---

## โ๏ธ ูฺฉุงุช ููู

### ฑ. Revalidation
ููุช ุฏุงุฏูโุง ุชุบุฑ ูโฺฉูุฏ (ูุซูุงู ฺฉุณุจโูฺฉุงุฑ ุฌุฏุฏ ุงุถุงูู ูโุดูุฏ):
- **Next.js Cache**: ุฎูุฏฺฉุงุฑ ุจุนุฏ ุงุฒ ฒ-ต ุฏููู ุจูโุฑูุฒ ูโุดูุฏ
- **Redis**: ูโุชูุงูุฏ manually ูพุงฺฉ ฺฉูุฏ ุง ุตุจุฑ ฺฉูุฏ TTL ุจฺฏุฐุฑุฏ

### ฒ. ููฺฏู ฑ.ด ูฺฏุงุจุงุช
ุญุชูุงู ููฺฏู ุฌุฏุฏ ุฑุง ุจุง ูุฑูุช WebP ุง SVG ุฌุงฺฏุฒู ฺฉูุฏ:
```bash
# ุจุง cwebp
 cwebp -q 80 logo.png -o logo.webp
```

### ณ. Region
ุงฺฏุฑ Vercel Pro ุฏุงุฑุฏุ region ุฑุง ุจู `fra1` (Frankfurt) ุชุบุฑ ุฏูุฏ:
- ูุฒุฏฺฉโุชุฑ ุจู Supabase Amsterdam
- Latency ฺฉูุชุฑ

---

## ๐ ฺฏุงูโูุง ุจุนุฏ (ุงุฎุชุงุฑ)

### ฑ. Edge Functions
ุจุฑุง APIโูุง ุณุจฺฉ ุงุฒ Edge Runtime ุงุณุชูุงุฏู ฺฉูุฏ:
```typescript
export const runtime = 'edge';
```

### ฒ. Image Optimization
- ููู ุนฺฉุณโูุง ุฑุง ุจู WebP ุชุจุฏู ฺฉูุฏ
- ุงุฒ `next/image` ุจุง `priority` ุจุฑุง ุนฺฉุณโูุง above-the-fold ุงุณุชูุงุฏู ฺฉูุฏ

### ณ. Bundle Size
```bash
npm run build
# ุจุฑุฑุณ ฺฉูุฏ ฺู ฺุฒูุง ุญุฌู ุฏุงุฑู
```

---

## ๐ ุนุจโุงุจ

### ุงฺฏุฑ ุณุงุช ููุฏ ููโุดูุฏ:
```bash
# ูุงฺฏโูุง ุฑุง ฺฺฉ ฺฉูุฏ
vercel logs --tail
```

### ุงฺฏุฑ ุฏุงุฏูโูุง ุจูโุฑูุฒ ููโุดููุฏ:
```bash
# Revalidate ุฏุณุช
curl -X POST https://your-site.com/api/revalidate?secret=your-secret
```

### ุงฺฏุฑ Redis ฺฉุงุฑ ููโฺฉูุฏ:
- ุจุฑุฑุณ ฺฉูุฏ `UPSTASH_REDIS_REST_URL` ู `UPSTASH_REDIS_REST_TOKEN` ูพุฑ ุดุฏูโุงูุฏ
- ุฏุฑ ฺฉูุณูู Upstash ูุถุนุช ุฏุชุงุจุณ ุฑุง ฺฺฉ ฺฉูุฏ

---

## ๐ฏ ุฎูุงุตู

ุจุง ุงู ุชุบุฑุงุช:
1. โ ISR ูุนุงู ุดุฏ
2. โ ููู ฺฉูุฑโูุง ฺฉุด ุดุฏูุฏ
3. โ N+1 Problem ุญู ุดุฏ
4. โ Redis ุขูุงุฏู ุงุณุช

**ูุชุฌู**: ุณุฑุนุช ููุฏ ุตูุญู ุงูู ุงุฒ ด ุซุงูู ุจู ุฒุฑ ฑ ุซุงูู ูโุฑุณุฏ! ๐
